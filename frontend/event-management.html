<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Management - EventPulse</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/event-management.css">
    <link rel="stylesheet" href="css/dark-mode.css">
    <!-- Leaflet CSS for interactive map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
        <script src="js/config.js"></script>
    <script src="js/dark-mode.js"></script>
    <script defer src="js/event-management.js"></script>
    
    <style>
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        /* Scroll offset for fixed header */
        section[id] {
            scroll-margin-top: 100px;
        }
        /* Custom category field animation */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        #customCategoryGroup {
            transition: all 0.3s ease;
        }
    </style>

    <script>
        // Navigation active link tracking
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('.nav-link');
            
            // Handle smooth scroll and active state on click
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);
                    
                    if (targetSection) {
                        // Remove active from all
                        navLinks.forEach(l => l.classList.remove('active'));
                        // Add active to clicked
                        link.classList.add('active');
                        // Scroll to section
                        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });

            // Update active link on scroll
            const sections = document.querySelectorAll('section[id]');
            const observerOptions = {
                root: null,
                rootMargin: '-20% 0px -70% 0px',
                threshold: 0
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${entry.target.id}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, observerOptions);

            sections.forEach(section => observer.observe(section));

            // Handle category dropdown - show/hide custom input
            const categorySelect = document.getElementById('eventCategory');
            const customCategoryGroup = document.getElementById('customCategoryGroup');
            const customCategoryInput = document.getElementById('customCategory');

            if (categorySelect && customCategoryGroup && customCategoryInput) {
                categorySelect.addEventListener('change', () => {
                    if (categorySelect.value === 'Other') {
                        customCategoryGroup.style.display = 'block';
                        customCategoryInput.required = true;
                        // Smooth slide in animation
                        customCategoryGroup.style.animation = 'slideIn 0.3s ease-out';
                    } else {
                        customCategoryGroup.style.display = 'none';
                        customCategoryInput.required = false;
                        customCategoryInput.value = '';
                    }
                });
            }
        });
    </script>
    
    <!-- Firebase Configuration (Disabled - Using MongoDB API) -->
    <script type="module">
        // Firebase imports
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { 
            getAuth, 
            signInWithCustomToken, 
            signInAnonymously, 
            onAuthStateChanged 
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { 
            getFirestore, 
            collection, 
            addDoc, 
            getDocs, 
            doc, 
            updateDoc, 
            deleteDoc, 
            onSnapshot,
            query,
            orderBy,
            Timestamp
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration (DISABLED - Using MongoDB instead)
        /*
        let app, auth, db, userId;
        const EVENTS_COLLECTION_PATH = 'events';

        // Initialize Firebase
        async function initializeFirebase() {
            try {
                const firebaseConfig = window.__firebase_config || {
                    apiKey: "AIzaSyDemoKey123456789",
                    authDomain: "eventpulse-demo.firebaseapp.com",
                    projectId: "eventpulse-demo",
                    storageBucket: "eventpulse-demo.appspot.com",
                    messagingSenderId: "123456789",
                    appId: "1:123456789:web:abc123def456"
                };

                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                // Sign in user
                const initialAuthToken = window.__initial_auth_token;
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                // Set up auth state listener
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log('‚úÖ User authenticated:', userId);
                        await addInitialMockEvents();
                        setupRealtimeDataListeners();
                        calculateKPIs();
                    } else {
                        console.log('‚ùå No user authenticated');
                    }
                });

            } catch (error) {
                console.error('‚ùå Firebase initialization error:', error);
                // Fallback to localStorage-based system
                initializeFallbackSystem();
            }
        }

        // Firebase functions disabled - using MongoDB API instead
        /*
        // Add initial mock events if collection is empty
        async function addInitialMockEvents() {
            try {
                const eventsRef = collection(db, EVENTS_COLLECTION_PATH);
                const snapshot = await getDocs(eventsRef);

                if (snapshot.empty) {
                    console.log('üì¶ Adding initial mock events...');
                    
                    const mockEvents = [
                        {
                            name: 'Tech Conference 2025',
                            date: '2025-11-15',
                            time: '09:00',
                            venue: 'Convention Center, Downtown',
                            description: 'Annual technology conference featuring the latest innovations in AI, cloud computing, and software development.',
                            organizer: userId,
                            status: 'Active',
                            attendees: 250,
                            price: 299,
                            createdAt: Timestamp.now()
                        },
                        {
                            name: 'Music Festival',
                            date: '2025-12-20',
                            time: '18:00',
                            venue: 'City Park Amphitheater',
                            description: 'Summer music festival featuring top local and international artists across multiple genres.',
                            organizer: userId,
                            status: 'Pending',
                            attendees: 500,
                            price: 75,
                            createdAt: Timestamp.now()
                        },
                        {
                            name: 'Business Networking Event',
                            date: '2025-10-25',
                            time: '19:00',
                            venue: 'Grand Hotel Ballroom',
                            description: 'Connect with industry professionals and expand your business network.',
                            organizer: userId,
                            status: 'Active',
                            attendees: 150,
                            price: 50,
                            createdAt: Timestamp.now()
                        },
                        {
                            name: 'Art Exhibition Opening',
                            date: '2025-09-10',
                            time: '14:00',
                            venue: 'Modern Art Gallery',
                            description: 'Opening night of contemporary art exhibition featuring emerging artists.',
                            organizer: userId,
                            status: 'Completed',
                            attendees: 180,
                            price: 25,
                            createdAt: Timestamp.now()
                        }
                    ];

                    for (const event of mockEvents) {
                        await addDoc(eventsRef, event);
                    }
                    
                    console.log('‚úÖ Mock events added successfully');
                }
            } catch (error) {
                console.error('‚ùå Error adding mock events:', error);
            }
        }

        // Set up real-time data listeners
        function setupRealtimeDataListeners() {
            try {
                const eventsRef = collection(db, EVENTS_COLLECTION_PATH);
                const q = query(eventsRef, orderBy('date', 'asc'));

                onSnapshot(q, (snapshot) => {
                    const events = [];
                    snapshot.forEach((doc) => {
                        events.push({ id: doc.id, ...doc.data() });
                    });
                    
                    console.log('üìä Real-time data updated:', events.length, 'events');
                    renderEventsList(events);
                    calculateKPIs(events);
                }, (error) => {
                    console.error('‚ùå Real-time listener error:', error);
                });
            } catch (error) {
                console.error('‚ùå Error setting up listeners:', error);
            }
        }

        // Calculate KPIs dynamically
        function calculateKPIs(events = []) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            let activeEvents = 0;
            let upcomingAttendees = 0;
            let projectedRevenue = 0;

            events.forEach(event => {
                const eventDate = new Date(event.date);
                eventDate.setHours(0, 0, 0, 0);

                if (eventDate >= today && event.status !== 'Completed') {
                    activeEvents++;
                    upcomingAttendees += event.attendees || 0;
                    projectedRevenue += (event.attendees || 0) * (event.price || 0);
                }
            });

            // Update metrics in UI
            const activeEventsEl = document.getElementById('metric-active-events');
            const attendeesEl = document.getElementById('metric-upcoming-attendees');
            const revenueEl = document.getElementById('metric-projected-revenue');

            if (activeEventsEl) activeEventsEl.textContent = activeEvents;
            if (attendeesEl) attendeesEl.textContent = upcomingAttendees.toLocaleString();
            if (revenueEl) revenueEl.textContent = formatCurrency(projectedRevenue);
        }

        // Render events list dynamically
        function renderEventsList(events) {
            const container = document.getElementById('myEvents');
            const emptyState = document.getElementById('emptyState');
            const eventCountBadge = document.getElementById('myEventsCount');

            if (!container) return;

            // Filter events by current user (organizer)
            const myEvents = events.filter(event => event.organizer === userId);

            // Update count badge
            if (eventCountBadge) {
                eventCountBadge.textContent = myEvents.length;
            }

            if (myEvents.length === 0) {
                container.style.display = 'none';
                if (emptyState) emptyState.classList.remove('hidden');
                return;
            }

            container.style.display = 'grid';
            if (emptyState) emptyState.classList.add('hidden');

            // Sort by date
            myEvents.sort((a, b) => new Date(a.date) - new Date(b.date));

            // Generate HTML
            container.innerHTML = myEvents.map(event => createEventCard(event)).join('');
        }

        // Create event card HTML
        function createEventCard(event) {
            const statusColors = {
                'Active': 'linear-gradient(135deg, #10b981, #059669)',
                'Pending': 'linear-gradient(135deg, #f59e0b, #d97706)',
                'Completed': 'linear-gradient(135deg, #6b7280, #4b5563)'
            };

            const statusColor = statusColors[event.status] || statusColors['Pending'];

            return `
                <div class="management-event-card">
                    <span class="event-badge" style="background: ${statusColor}">${event.status || 'Pending'}</span>
                    <h3>${event.name}</h3>
                    <div class="event-meta">
                        <div class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            <span>${new Date(event.date).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</span>
                        </div>
                        <div class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            <span>${event.time || 'Time not set'}</span>
                        </div>
                        <div class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                <circle cx="12" cy="10" r="3"></circle>
                            </svg>
                            <span>${event.venue}</span>
                        </div>
                        <div class="meta-item">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            <span>${event.attendees || 0} attendees</span>
                        </div>
                    </div>
                    <p class="event-description">${event.description}</p>
                    <div class="card-actions">
                        <button class="edit-btn" onclick="handleEditEvent('${event.id}')">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Edit
                        </button>
                        <button class="delete-btn" onclick="handleDeleteEvent('${event.id}', '${event.name}')">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                            Delete
                        </button>
                    </div>
                </div>
            `;
        }
        */
        // End of Firebase functions

        // Handle edit event
        window.handleEditEvent = async function(eventId) {
            try {
                // Fetch event data from MongoDB API
                const response = await fetch(`${API_CONFIG.BASE_URL}/events/${eventId}`);
                
                if (!response.ok) {
                    showToast('‚ùå Event not found', 'error');
                    return;
                }
                
                const eventData = await response.json();

                // Scroll to top and populate form
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Populate the create event form with existing data
                document.getElementById('eventName').value = eventData.name || '';
                
                // Handle category (check if it's predefined or custom)
                const categorySelect = document.getElementById('eventCategory');
                const customCategoryInput = document.getElementById('customCategory');
                const customCategoryGroup = document.getElementById('customCategoryGroup');
                const predefinedCategories = ['Conference', 'Workshop', 'Seminar', 'Webinar', 'Networking', 'Concert', 'Festival', 'Sports', 'Charity', 'Exhibition', 'Training', 'Meetup', 'Party', 'Competition'];
                
                if (eventData.category && predefinedCategories.includes(eventData.category)) {
                    categorySelect.value = eventData.category;
                    customCategoryGroup.style.display = 'none';
                } else if (eventData.category) {
                    categorySelect.value = 'Other';
                    customCategoryInput.value = eventData.category;
                    customCategoryGroup.style.display = 'block';
                    customCategoryInput.required = true;
                }
                
                document.getElementById('eventDate').value = eventData.date || '';
                document.getElementById('eventTime').value = eventData.time || '';
                document.getElementById('eventVenue').value = eventData.venue || '';
                document.getElementById('eventDescription').value = eventData.description || '';
                document.getElementById('eventCapacity').value = eventData.capacity || 100;
                
                // Add all status options when editing (including Closed, Completed, Cancelled)
                const statusSelect = document.getElementById('eventStatus');
                statusSelect.innerHTML = `
                    <option value="Draft">Draft - Not visible to users</option>
                    <option value="Active">Active - Registration open</option>
                    <option value="Closed">Closed - Registration closed</option>
                    <option value="Completed">Completed - Event finished</option>
                    <option value="Cancelled">Cancelled</option>
                `;
                statusSelect.value = eventData.status || 'Draft';
                
                // Change button to update mode
                const addEventBtn = document.getElementById('addEventBtn');
                addEventBtn.textContent = 'üíæ Update Event';
                addEventBtn.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
                
                // Store the event ID for updating
                addEventBtn.setAttribute('data-edit-id', eventId);
                
                // Show cancel button
                let cancelBtn = document.getElementById('cancelEditBtn');
                if (!cancelBtn) {
                    cancelBtn = document.createElement('button');
                    cancelBtn.id = 'cancelEditBtn';
                    cancelBtn.className = 'cancel-edit-btn';
                    cancelBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                        Cancel Edit
                    `;
                    addEventBtn.parentNode.appendChild(cancelBtn);
                    
                    cancelBtn.addEventListener('click', () => {
                        resetCreateForm();
                    });
                }
                
                // Highlight the section
                const createSection = document.querySelector('.management-section');
                createSection.style.border = '3px solid #f59e0b';
                createSection.style.boxShadow = '0 8px 30px rgba(245, 158, 11, 0.3)';
                
                showToast('üìù Edit mode activated - Update the form below', 'info');
            } catch (error) {
                console.error('‚ùå Error fetching event:', error);
                showToast('‚ùå Error loading event data', 'error');
            }
        };

        // Reset create form to normal mode
        function resetCreateForm() {
            document.getElementById('eventName').value = '';
            document.getElementById('eventDate').value = '';
            document.getElementById('eventTime').value = '';
            document.getElementById('eventVenue').value = '';
            document.getElementById('eventDescription').value = '';
            
            const addEventBtn = document.getElementById('addEventBtn');
            addEventBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
                Create Event
            `;
            addEventBtn.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
            addEventBtn.removeAttribute('data-edit-id');
            
            const cancelBtn = document.getElementById('cancelEditBtn');
            if (cancelBtn) {
                cancelBtn.remove();
            }
            
            const createSection = document.querySelector('.management-section');
            createSection.style.border = 'none';
            createSection.style.boxShadow = 'none';
            
            showToast('Edit mode cancelled', 'info');
        }

        // Note: handleCreateEvent and updateExistingEvent are now in event-management.js
        // to prevent duplicate API calls and toast notifications

        // Handle delete event (Firebase version - currently disabled)
        window.handleDeleteEvent = async function(eventId, eventName) {
            if (confirm(`Are you sure you want to delete "${eventName}"?`)) {
                try {
                    const eventRef = doc(db, EVENTS_COLLECTION_PATH, eventId);
                    await deleteDoc(eventRef);
                    showToast(`üóëÔ∏è "${eventName}" deleted successfully!`, 'success');
                } catch (error) {
                    console.error('‚ùå Error deleting event:', error);
                    showToast('‚ùå Error deleting event.', 'error');
                }
            }
        };

        // Setup navigation function - DISABLED (event-management.js handles all listeners)
        // This function is kept for reference but should never be called
        /*
        function setupNavigation() {
            const createEventBtn = document.getElementById('addEventBtn');
            if (createEventBtn) {
                createEventBtn.addEventListener('click', handleCreateEvent);
            }

            // Navigation links
            document.querySelectorAll('.main-nav a').forEach(link => {
                link.addEventListener('click', (e) => {
                    const href = e.target.getAttribute('href');
                    if (href && href !== 'event-management.html') {
                        console.log('Navigating to:', href);
                    }
                });
            });
        }
        */

        // Utility: Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0
            }).format(amount);
        }

        // Utility: Show toast notification
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.textContent = message;
            
            let bgColor = 'linear-gradient(135deg, #667eea, #764ba2)';
            if (type === 'success') bgColor = 'linear-gradient(135deg, #10b981, #059669)';
            if (type === 'error') bgColor = 'linear-gradient(135deg, #ef4444, #dc2626)';
            
            toast.style.cssText = `
                position: fixed;
                bottom: 30px;
                right: 30px;
                background: ${bgColor};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                z-index: 10000;
                animation: slideInUp 0.3s ease-out;
                font-weight: 600;
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutDown 0.3s ease-out';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Initialize when DOM is ready (MongoDB system only)
        document.addEventListener('DOMContentLoaded', () => {
            // Firebase disabled - using MongoDB API
            // Note: event-management.js handles all event listeners and display
            // setupNavigation();
            
            // Add dynamic help text for status selection
            const statusSelect = document.getElementById('eventStatus');
            const helpText = document.getElementById('statusHelpText');
            
            const statusMessages = {
                'Draft': 'üí° Event is hidden from users. Perfect while you\'re still planning!',
                'Active': 'Registration is open! Users can now sign up for this event.',
                'Closed': 'üîí Registration closed. No new sign-ups allowed.',
                'Completed': 'Event has finished. Marked as completed.',
                'Cancelled': '‚ùå Event cancelled. This will be marked as cancelled.'
            };
            
            statusSelect.addEventListener('change', function() {
                const selectedStatus = this.value;
                if (helpText && statusMessages[selectedStatus]) {
                    helpText.textContent = statusMessages[selectedStatus];
                    helpText.style.animation = 'none';
                    setTimeout(() => {
                        helpText.style.animation = 'fadeInUp 0.3s ease';
                    }, 10);
                }
            });
        });
    </script>
    <link rel="stylesheet" href="css/icon-animations.css">
</head>
<body>

    <!-- Header -->
    <header>
        <nav>
            <div class="nav-left">
                <a href="organizer-dashboard.html" class="logo">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 4H5C3.89543 4 3 4.89543 3 6V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V6C21 4.89543 20.1046 4 19 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 10H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="15" r="2" fill="currentColor"/>
                    </svg>
                    EventPulse
                </a>
            </div>
            <div class="nav-center">
                <a href="event-management.html" class="active">Create Event</a>
                <a href="my-events.html">My Events</a>
                <a href="organizer-dashboard.html">Dashboard</a>
            </div>
            <div class="nav-right">
                <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode" title="Toggle Dark Mode">
                    <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
                <span class="organizer-name" id="organizerName"></span>
                <button id="logout-btn" class="logout-btn">Logout</button>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="management-container">
        <div class="page-header">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="16"></line>
                <line x1="8" y1="12" x2="16" y2="12"></line>
            </svg>
            <h1>Create Event</h1>
        </div>

        <!-- Create Event Section -->
        <section class="management-section" id="create-event">
            <div class="section-header">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
                <h2>Create New Event</h2>
            </div>

            <div class="add-event-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="eventName">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                            Event Name
                        </label>
                        <input type="text" id="eventName" placeholder="Enter event name" required>
                    </div>

                    <div class="form-group">
                        <label for="eventCategory">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                            Event Category
                        </label>
                        <select id="eventCategory" required>
                            <option value="" disabled selected>Select a category</option>
                            <option value="Conference">Conference</option>
                            <option value="Workshop">Workshop</option>
                            <option value="Seminar">Seminar</option>
                            <option value="Webinar">Webinar</option>
                            <option value="Networking">Networking</option>
                            <option value="Concert">Concert</option>
                            <option value="Festival">Festival</option>
                            <option value="Sports">Sports</option>
                            <option value="Charity">Charity</option>
                            <option value="Exhibition">Exhibition</option>
                            <option value="Training">Training</option>
                            <option value="Meetup">Meetup</option>
                            <option value="Party">Party</option>
                            <option value="Competition">Competition</option>
                            <option value="Other">Other (Specify)</option>
                        </select>
                    </div>

                    <div class="form-group" id="customCategoryGroup" style="display: none;">
                        <label for="customCategory">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Custom Category
                        </label>
                        <input type="text" id="customCategory" placeholder="Enter your custom category">
                    </div>

                    <div class="form-group">
                        <label for="eventDate">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            Event Date
                        </label>
                        <input type="date" id="eventDate" required>
                    </div>

                    <div class="form-group">
                        <label for="eventTime">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            Event Time
                        </label>
                        <input type="time" id="eventTime" required>
                    </div>

                    <div class="form-group">
                        <label for="eventVenue">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                <circle cx="12" cy="10" r="3"></circle>
                            </svg>
                            Venue
                        </label>
                        <input type="text" id="eventVenue" placeholder="Enter venue location" required>
                    </div>

                    <!-- Interactive Location Picker -->
                    <div class="form-group full-width">
                        <label>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                <circle cx="12" cy="10" r="3"></circle>
                            </svg>
                            Event Location on Map
                        </label>
                        <small style="color: #64748b; margin-bottom: 10px; display: block;">
                            üìç Click on the map to set the exact location of your event
                        </small>
                        <div id="locationPickerMap" style="height: 400px; border-radius: 12px; overflow: hidden; margin-bottom: 10px;"></div>
                        <div style="display: flex; gap: 10px; align-items: center; color: #64748b; font-size: 0.9rem;">
                            <span id="coordinatesDisplay">
                                No location selected yet
                            </span>
                            <button type="button" id="clearLocationBtn" style="display: none; padding: 5px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem;">
                                Clear Location
                            </button>
                        </div>
                        <input type="hidden" id="eventLat" name="lat">
                        <input type="hidden" id="eventLng" name="lng">
                    </div>

                    <div class="form-group full-width">
                        <label>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            Description
                        </label>
                        <textarea id="eventDescription" rows="4" placeholder="Describe your event..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            Maximum Capacity
                        </label>
                        <input type="number" id="eventCapacity" min="1" placeholder="e.g., 100" required>
                    </div>

                    <!-- Ticket Pricing Section -->
                    <div class="form-group full-width">
                        <label>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                                <line x1="1" y1="10" x2="23" y2="10"></line>
                            </svg>
                            Event Type
                        </label>
                        <div style="display: flex; gap: 20px; margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="eventType" value="free" id="eventTypeFree" checked>
                                <span>üÜì Free Event</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="eventType" value="paid" id="eventTypePaid">
                                <span>Paid Event</span>
                            </label>
                        </div>
                        
                        <!-- Ticket Price Field (hidden by default) -->
                        <div id="ticketPriceField" style="display: none; margin-top: 10px;">
                            <label style="font-size: 0.9rem; color: #64748b;">
                                Ticket Price (‚Çπ)
                            </label>
                            <input type="number" id="ticketPrice" min="0" step="0.01" placeholder="e.g., 500">
                        </div>
                    </div>

                    <div class="form-group status-field">
                        <label>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="16" x2="12" y2="12"></line>
                                <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            </svg>
                            Event Status
                        </label>
                        <div class="status-select-wrapper">
                            <select id="eventStatus" required>
                                <!-- Initial options for new events -->
                                <option value="Draft">Draft - Not visible to users</option>
                                <option value="Active" selected>Active - Registration open</option>
                                <!-- Additional options added dynamically when editing -->
                            </select>
                        </div>
                        <small class="status-help-text" id="statusHelpText">
                            Choose Draft to keep planning, or Active to open registration
                        </small>
                    </div>
                </div>

                <!-- üé§ Speakers Section -->
                <div class="speakers-management-section">
                    <div class="section-header">
                        <h3>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px; vertical-align: middle;">
                                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                                <line x1="12" y1="19" x2="12" y2="22"></line>
                            </svg>
                            Speakers & Chief Guests
                        </h3>
                        <p style="color: #64748b; font-size: 0.9rem; margin-top: 5px;">Add speakers, chief guests, or panelists for your event (Optional)</p>
                    </div>

                    <div id="speakersContainer">
                        <!-- Speaker entries will be added here dynamically -->
                    </div>

                    <button type="button" id="addSpeakerBtn" class="secondary-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 18px; height: 18px;">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add Speaker
                    </button>
                </div>

                <button id="addEventBtn" class="primary-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                    Create Event
                </button>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 EventPulse. All rights reserved.</p>
    </footer>

    <!-- Speaker Template -->
    <template id="speakerTemplate">
        <div class="speaker-entry">
            <div class="speaker-header">
                <h4>üé§ Speaker Details</h4>
                <button type="button" class="remove-speaker-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                    Remove
                </button>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Speaker Name *</label>
                    <input type="text" class="speaker-name" placeholder="e.g., Dr. John Doe" required>
                </div>

                <div class="form-group">
                    <label>Role/Category</label>
                    <select class="speaker-role">
                        <option value="Speaker">Speaker</option>
                        <option value="Chief Guest">Chief Guest</option>
                        <option value="Keynote Speaker">Keynote Speaker</option>
                        <option value="Panelist">Panelist</option>
                        <option value="Workshop Instructor">Workshop Instructor</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>Designation/Title</label>
                <input type="text" class="speaker-designation" placeholder="e.g., CEO at TechCorp, Professor at MIT">
            </div>

            <div class="form-group">
                <label>Biography</label>
                <textarea class="speaker-bio" rows="3" placeholder="Brief professional background and achievements..."></textarea>
            </div>

            <div class="form-group">
                <label>Speaking Topic</label>
                <input type="text" class="speaker-topic" placeholder="What will they discuss at the event?">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Session Time (Optional)</label>
                    <input type="time" class="speaker-time">
                </div>

                <div class="form-group">
                    <label>Profile Photo</label>
                    <input type="file" class="speaker-photo" accept="image/*">
                    <small style="color: #64748b;">Max 2MB, JPG/PNG/WEBP</small>
                </div>
            </div>

            <div class="form-group">
                <label>Social Media Links (Optional)</label>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <input type="url" class="speaker-linkedin" placeholder="LinkedIn profile URL">
                    <input type="url" class="speaker-twitter" placeholder="Twitter/X profile URL">
                    <input type="url" class="speaker-website" placeholder="Personal website URL">
                </div>
            </div>

            <div class="speaker-photo-preview" style="display: none;">
                <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 8px;">Photo Preview:</p>
                <img src="" alt="Speaker photo preview">
            </div>
        </div>
    </template>

    <!-- Speaker Styles -->
    <style>
        .speakers-management-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);
            border-radius: 12px;
            border: 2px dashed #667eea;
        }

        .section-header h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .speaker-entry {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .speaker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .speaker-header h4 {
            margin: 0;
            color: #333;
            font-size: 1.1rem;
        }

        .remove-speaker-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
        }

        .remove-speaker-btn:hover {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
        }

        .secondary-btn {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .secondary-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .speaker-photo-preview {
            margin-top: 15px;
            text-align: center;
            padding: 15px;
            background: #f9fafb;
            border-radius: 8px;
        }

        .speaker-photo-preview img {
            max-width: 200px;
            max-height: 200px;
            border-radius: 50%;
            border: 4px solid #667eea;
            object-fit: cover;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <!-- Points System -->
    <script src="js/points-system.js"></script>
    <link rel="stylesheet" href="css/points-system.css">
</body>
</html>


